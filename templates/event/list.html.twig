{% extends './base.html.twig' %}

{% block title %}Event List{% endblock %}

{% block body %}
    <div class="container mx-auto p-4 mt-16">
        <h1 class="text-3xl font-bold mb-5">Event List</h1>

        <div class="grid gap-6 grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4">
            {% for event in events %}
                <div class="bg-white rounded-lg shadow-md overflow-hidden">
                    <div class="px-6 py-4">
                        <h5 class="text-xl font-semibold mb-2">{{ event.name }}</h5>
                        <p class="text-gray-600">Date: {{ event.date|date('Y-m-d H:i') }}</p>
                        <p class="text-gray-600">Registration Limit: {{ event.registrationLimit }}</p>
                        <p class="text-gray-600">Registrations: {{ event.users|length }}</p>
                    </div>
                    <div class="px-6 py-4 bg-gray-100">
                        {% set now = date() %}
                        {% if event.date < now %}
                            <span class="text-red-500 font-semibold">Event has expired</span>
                        {% elseif event.users|length >= event.registrationLimit %}
                            <span class="text-red-500 font-semibold">Full</span>
                        {% else %}
                            <a href="{{ path('user_register', {id: event.id}) }}"
                               class="inline-block bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                                Register
                            </a>
                        {% endif %}
                    </div>
                </div>
            {% else %}
                <div class="bg-yellow-100 text-yellow-700 p-4 rounded" role="alert">
                    No events found.
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}
